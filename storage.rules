rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    
    // Allow writes only to a user-specific folder within tradTest
    // The user must be authenticated and their UID must match the folder name.
    match /tradTest/{userId}/{allPaths=**} {
      allow write: if request.auth != null && request.auth.uid == userId;
      allow read: if request.auth != null; // Allow any authenticated user to read
    }

    // Allow writes for test submissions by candidates
    match /testSubmissions/{postId}/{candidateId}/{fileName} {
      allow write: if request.auth != null && request.auth.uid == candidateId;
      allow read: if request.auth != null; // Allow any authenticated user to read
    }
  }
}
